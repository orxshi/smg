\documentclass{article}

\usepackage{tikz, tikz-3dplot}
\usepackage{float}
\usepackage{booktabs}
\usepackage{fp}
\usepackage{listings}

\lstset{language=C++,
                basicstyle=\ttfamily,
                keywordstyle=\color{blue}\ttfamily,
                stringstyle=\color{red}\ttfamily,
                commentstyle=\color{green}\ttfamily,
                morecomment=[l][\color{magenta}]{\#}
}

\newcommand{\clen}{4.0}

\begin{document}

\section{Coordinate system}

\begin{figure}[H]
\centering

\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[dashed, color=red] (O) -- (Px);
\draw[dashed, color=red] (O) -- (Py);
\draw[dashed, color=red] (O) -- (Pz);
\draw[dashed, color=red] (Px) -- (Pxy);
\draw[dashed, color=red] (Py) -- (Pxy);
\draw[dashed, color=red] (Px) -- (Pxz);
\draw[dashed, color=red] (Pz) -- (Pxz);
\draw[dashed, color=red] (Py) -- (Pyz);
\draw[dashed, color=red] (Pz) -- (Pyz);
\draw[dashed, color=red] (Pxy) -- (P);
\draw[dashed, color=red] (Pxz) -- (P);
\draw[dashed, color=red] (Pyz) -- (P);
\end{tikzpicture}


\end{figure}

\section{Mesh resolution}

Provide $ni$, $nj$, $nk$.

\section{Indices}

Only points and cells use IJK indices. Surfaces and faces have numerals.

\section{Corner points}

There $(ni+1)\times (nj+1) \times (nk+1)$ points will be allocated.

Provide 8 corner points in the following order.

\begin{center}
\begin{tabular}{llll}
Point & I & J & K\\
	  \midrule
	  0 & $i$ & $j$ & $k$\\
	      1 & $i+1$ & $j$ & $k$\\
	      2 & $i+1$ & $j+1$ & $k$\\
	      3 & $i$ & $j+1$ & $k$\\
	      4 & $i$ & $j$ & $k+1$\\
	      5 & $i+1$ & $j$ & $k+1$\\
	      6 & $i+1$ & $j+1$ & $k+1$\\
	      7 & $i$ & $j+1$ & $k+1$
	      \end{tabular}
	      \end{center}

	      \begin{figure}[H]
	      \centering
	      \tdplotsetmaincoords{60}{130}

	      \begin{tikzpicture}[scale=2,tdplot_main_coords]
	      \coordinate (O) at (0,0,0);
	      \tdplotsetcoord{P}{1.732}{54.74}{45}

	      \draw[color=red] (O) -- (Px);
	      \draw[color=red] (O) -- (Py);
	      \draw[color=red] (O) -- (Pz);
	      \draw[color=red] (Px) -- (Pxy);
	      \draw[color=red] (Py) -- (Pxy);
	      \draw[color=red] (Px) -- (Pxz);
	      \draw[color=red] (Pz) -- (Pxz);
	      \draw[color=red] (Py) -- (Pyz);
	      \draw[color=red] (Pz) -- (Pyz);
	      \draw[color=red] (Pxy) -- (P);
	      \draw[color=red] (Pxz) -- (P);
	      \draw[color=red] (Pyz) -- (P);

	      \fill (0.0,0.0) circle (0.3mm) node[anchor=east]{0};
\fill (Px) circle (0.3mm) node[anchor=east]{1};
\fill (Pxy) circle (0.3mm) node[anchor=east]{2};
\fill (Py) circle (0.3mm) node[anchor=east]{3};

\fill (Pz) circle (0.3mm) node[anchor=east]{4};
\fill (Pxz) circle (0.3mm) node[anchor=east]{5};
\fill (P) circle (0.3mm) node[anchor=east]{6};
\fill (Pyz) circle (0.3mm) node[anchor=east]{7};
\end{tikzpicture}
\end{figure}

\section{Generating edge points}

Lines are made in the following order.

\begin{figure}[H]
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red,->] (O) -- node[black]{$0$} (Px);
\draw[color=red,->] (O) -- node[black]{$3$} (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red,->] (Px) -- node[black]{$1$} (Pxy);
\draw[color=red,->] (Py) -- node[black]{$2$} (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red,->] (Pz) -- node[black]{$4$} (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red,->] (Pz) -- node[black]{$7$} (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red,->] (Pxz) -- node[black]{$5$} (P);
\draw[color=red,->] (Pyz) -- node[black]{$6$}(P);

\end{tikzpicture}
\end{figure}

WARNING: Edge points in along k-direction will be generated during generation of surface points on IK plane.

%\begin{figure}[H]
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red,->] (O) -- node[black]{$8$} (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red,->] (Px) -- node[black]{$9$} (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red,->] (Py) -- node[black]{$11$} (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red,->] (Pxy) -- node[black]{$10$} (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{figure}

Discretize lines 0, 2, 4, 6 to $ni$ points. With initial and end points, you will end up with $ni$ points.

\begin{minipage}{.45\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\fill (0.0,0.0,0.0) circle (0.3mm);
\fill (0.2,0.0,0.0) circle (0.3mm) ;
\fill (0.4,0.0,0.0) circle (0.3mm) ;
\fill (0.6,0.0,0.0) circle (0.3mm) ;
\fill (0.8,0.0,0.0) circle (0.3mm) ;
\fill (1.0,0.0,0.0) circle (0.3mm) ;

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.45\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\fill (0.0,1.0,0.0) circle (0.3mm);
\fill (0.2,1.0,0.0) circle (0.3mm) ;
\fill (0.4,1.0,0.0) circle (0.3mm) ;
\fill (0.6,1.0,0.0) circle (0.3mm) ;
\fill (0.8,1.0,0.0) circle (0.3mm) ;
\fill (1.0,1.0,0.0) circle (0.3mm) ;

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\end{tikzpicture}
\end{minipage}

\begin{minipage}{.45\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\fill (0.0,0.0,1.0) circle (0.3mm);
\fill (0.2,0.0,1.0) circle (0.3mm) ;
\fill (0.4,0.0,1.0) circle (0.3mm) ;
\fill (0.6,0.0,1.0) circle (0.3mm) ;
\fill (0.8,0.0,1.0) circle (0.3mm) ;
\fill (1.0,0.0,1.0) circle (0.3mm) ;

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.45\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\fill (0.0,1.0,1.0) circle (0.3mm);
\fill (0.2,1.0,1.0) circle (0.3mm) ;
\fill (0.4,1.0,1.0) circle (0.3mm) ;
\fill (0.6,1.0,1.0) circle (0.3mm) ;
\fill (0.8,1.0,1.0) circle (0.3mm) ;
\fill (1.0,1.0,1.0) circle (0.3mm) ;

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\end{tikzpicture}
\end{minipage}

WARNING: Edge points in other planes will be generated implicitly during generation of inner points.


%Discretize lines 1, 3, 5, 7 to $nj$ points.
%
%\begin{minipage}{.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (1.0,0.0,0.0) circle (0.3mm);
%\fill (1.0,0.2,0.0) circle (0.3mm) ;
%\fill (1.0,0.4,0.0) circle (0.3mm) ;
%\fill (1.0,0.6,0.0) circle (0.3mm) ;
%\fill (1.0,0.8,0.0) circle (0.3mm) ;
%\fill (1.0,1.0,0.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}
%\begin{minipage}{0.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (0.0,0.0,0.0) circle (0.3mm);
%\fill (0.0,0.2,0.0) circle (0.3mm) ;
%\fill (0.0,0.4,0.0) circle (0.3mm) ;
%\fill (0.0,0.6,0.0) circle (0.3mm) ;
%\fill (0.0,0.8,0.0) circle (0.3mm) ;
%\fill (0.0,1.0,0.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}
%
%\begin{minipage}{.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (1.0,0.0,1.0) circle (0.3mm);
%\fill (1.0,0.2,1.0) circle (0.3mm) ;
%\fill (1.0,0.4,1.0) circle (0.3mm) ;
%\fill (1.0,0.6,1.0) circle (0.3mm) ;
%\fill (1.0,0.8,1.0) circle (0.3mm) ;
%\fill (1.0,1.0,1.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}
%\begin{minipage}{0.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (0.0,0.0,1.0) circle (0.3mm);
%\fill (0.0,0.2,1.0) circle (0.3mm) ;
%\fill (0.0,0.4,1.0) circle (0.3mm) ;
%\fill (0.0,0.6,1.0) circle (0.3mm) ;
%\fill (0.0,0.8,1.0) circle (0.3mm) ;
%\fill (0.0,1.0,1.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}
%
%Discretize lines 8, 9, 10, 11 to $nk$ points.
%
%\begin{minipage}{.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (0.0,0.0,0.0) circle (0.3mm);
%\fill (0.0,0.0,0.2) circle (0.3mm) ;
%\fill (0.0,0.0,0.4) circle (0.3mm) ;
%\fill (0.0,0.0,0.6) circle (0.3mm) ;
%\fill (0.0,0.0,0.8) circle (0.3mm) ;
%\fill (0.0,0.0,1.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}
%\begin{minipage}{0.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (1.0,0.0,0.0) circle (0.3mm);
%\fill (1.0,0.0,0.2) circle (0.3mm) ;
%\fill (1.0,0.0,0.4) circle (0.3mm) ;
%\fill (1.0,0.0,0.6) circle (0.3mm) ;
%\fill (1.0,0.0,0.8) circle (0.3mm) ;
%\fill (1.0,0.0,1.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}
%
%\begin{minipage}{.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (1.0,1.0,0.0) circle (0.3mm);
%\fill (1.0,1.0,0.2) circle (0.3mm) ;
%\fill (1.0,1.0,0.4) circle (0.3mm) ;
%\fill (1.0,1.0,0.6) circle (0.3mm) ;
%\fill (1.0,1.0,0.8) circle (0.3mm) ;
%\fill (1.0,1.0,1.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}
%\begin{minipage}{0.45\textwidth}
%\centering
%\tdplotsetmaincoords{60}{130}
%
%\begin{tikzpicture}[scale=2,tdplot_main_coords]
%\coordinate (O) at (0,0,0);
%\tdplotsetcoord{P}{1.732}{54.74}{45}
%
%\fill (0.0,1.0,0.0) circle (0.3mm);
%\fill (0.0,1.0,0.2) circle (0.3mm) ;
%\fill (0.0,1.0,0.4) circle (0.3mm) ;
%\fill (0.0,1.0,0.6) circle (0.3mm) ;
%\fill (0.0,1.0,0.8) circle (0.3mm) ;
%\fill (0.0,1.0,1.0) circle (0.3mm) ;
%
%\draw[color=red] (O) -- (Px);
%\draw[color=red] (O) -- (Py);
%\draw[color=red] (O) -- (Pz);
%\draw[color=red] (Px) -- (Pxy);
%\draw[color=red] (Py) -- (Pxy);
%\draw[color=red] (Px) -- (Pxz);
%\draw[color=red] (Pz) -- (Pxz);
%\draw[color=red] (Py) -- (Pyz);
%\draw[color=red] (Pz) -- (Pyz);
%\draw[color=red] (Pxy) -- (P);
%\draw[color=red] (Pxz) -- (P);
%\draw[color=red] (Pyz) -- (P);
%
%\end{tikzpicture}
%\end{minipage}

	\subsection{Generation of surface points}

	\begin{figure}[H]
	\centering

	\tdplotsetmaincoords{60}{130}

	\begin{tikzpicture}[scale=2,tdplot_main_coords]
	\coordinate (O) at (0,0,0);
	\tdplotsetcoord{P}{1.732}{54.74}{45}
	\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,0,0.1) -- (0.2,0,0.9);
\draw[color=blue] (0.4,0,0.1) -- (0.4,0,0.9);
\draw[color=blue] (0.6,0,0.1) -- (0.6,0,0.9);
\draw[color=blue] (0.8,0,0.1) -- (0.8,0,0.9);

\end{tikzpicture}

\begin{lstlisting}
for (int i=0; i<ni+1; ++i)
{
    Line l(p[i][0][0], p[i][0][nk]);

    for (int k=1; k<nk; ++k)
    {
	auto pts = l.generate(nk);
	p[i][0][k] = pts[k];
    }
}
\end{lstlisting}

\end{figure}

\begin{figure}[H]
\centering

\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,1.0,0.1) -- (0.2,1.0,0.9);
\draw[color=blue] (0.4,1.0,0.1) -- (0.4,1.0,0.9);
\draw[color=blue] (0.6,1.0,0.1) -- (0.6,1.0,0.9);
\draw[color=blue] (0.8,1.0,0.1) -- (0.8,1.0,0.9);

\end{tikzpicture}
\end{figure}

\begin{lstlisting}
for (int i=0; i<ni+1; ++i)
{
    Line l(p[i][nj][0], p[i][nj][nk]);

    for (int k=1; k<nk; ++k)
    {
	auto pts = l.generate(nk);
	p[i][nj][k] = pts[k];
    }
}
\end{lstlisting}

At this stage, you should have the points in the figures below. The points are shown in two figures for easy visualization.

\begin{minipage}{0.45\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\j{0.0}
    \foreach \i in {0.0,0.2,...,1.0}{
	\FPadd\ia\i\a
	    \foreach \k in {0.0,0.2,...,1.0}{
		\FPadd\ka\k\a

		    \fill (\i,\j,\k) circle (0.3mm) ;
	    }
    }

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.45\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\j{1.0}
    \foreach \i in {0.0,0.2,...,1.0}{
	\FPadd\ia\i\a
	    \foreach \k in {0.0,0.2,...,1.0}{
		\FPadd\ka\k\a

		    \fill (\i,\j,\k) circle (0.3mm) ;
	    }
    }

\end{tikzpicture}
\end{minipage}

WARNING: Surface points in other planes will be generated implicitly during generation of inner points.

\subsection{Generation of inner points}

Connect surface points. Make lines from $i=[0,ni]$, $j=[0,nj]$ and $k=[0,nk]$. Then, discretize to generate inner points.

\begin{minipage}{.45\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,0.0,0.0) -- (0.2,1.0,0.0);
\draw[color=blue] (0.4,0.0,0.0) -- (0.4,1.0,0.0);
\draw[color=blue] (0.6,0.0,0.0) -- (0.6,1.0,0.0);
\draw[color=blue] (0.8,0.0,0.0) -- (0.8,1.0,0.0);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{.45\textwidth}
\centering

\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,0.0,0.2) -- (0.2,1.0,0.2);
\draw[color=blue] (0.4,0.0,0.2) -- (0.4,1.0,0.2);
\draw[color=blue] (0.6,0.0,0.2) -- (0.6,1.0,0.2);
\draw[color=blue] (0.8,0.0,0.2) -- (0.8,1.0,0.2);

\end{tikzpicture}
\end{minipage}

\begin{minipage}{.45\textwidth}
\centering

\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,0.0,0.4) -- (0.2,1.0,0.4);
\draw[color=blue] (0.4,0.0,0.4) -- (0.4,1.0,0.4);
\draw[color=blue] (0.6,0.0,0.4) -- (0.6,1.0,0.4);
\draw[color=blue] (0.8,0.0,0.4) -- (0.8,1.0,0.4);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{.45\textwidth}
\centering

\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,0.0,0.6) -- (0.2,1.0,0.6);
\draw[color=blue] (0.4,0.0,0.6) -- (0.4,1.0,0.6);
\draw[color=blue] (0.6,0.0,0.6) -- (0.6,1.0,0.6);
\draw[color=blue] (0.8,0.0,0.6) -- (0.8,1.0,0.6);

\end{tikzpicture}
\end{minipage}

\begin{minipage}{.45\textwidth}
\centering

\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,0.0,0.8) -- (0.2,1.0,0.8);
\draw[color=blue] (0.4,0.0,0.8) -- (0.4,1.0,0.8);
\draw[color=blue] (0.6,0.0,0.8) -- (0.6,1.0,0.8);
\draw[color=blue] (0.8,0.0,0.8) -- (0.8,1.0,0.8);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{.45\textwidth}
\centering

\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}
\draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$i$};
\draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$j$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$k$};

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.2,0.0,1.0) -- (0.2,1.0,1.0);
\draw[color=blue] (0.4,0.0,1.0) -- (0.4,1.0,1.0);
\draw[color=blue] (0.6,0.0,1.0) -- (0.6,1.0,1.0);
\draw[color=blue] (0.8,0.0,1.0) -- (0.8,1.0,1.0);

\end{tikzpicture}
\end{minipage}



\begin{lstlisting}
for (int i=0; i<ni+1; ++i)
{
    for (int k=0; k<nk+1; ++k)
    {
	Line l(p[i][0][k], p[i][nj][k]);
	auto pts = l.generate(nj);
	for (int j=1; j<nj; ++j)
	{
	    p[i][j][k] = pts[j];
	}
    }
}
\end{lstlisting}



\section{Making surfaces}

\subsection{IJ surfaces}

\begin{lstlisting}
for (int j=0; j<nj; ++j)
{
    for (int i=0; i<ni; ++i)
    {
	(i,j,0) , (i+1, j, 0) , (i+1, j+1, 0) , (i, j+1, 0);
        (i,j,nk), (i+1, j, nk), (i+1, j+1, nk), (i, j+1, nk);
    }

    parent of lower surface: 
	cell (i, j, 0)
    parent of upper surface: 
	cell (i, j, nk-1)
}
\end{lstlisting}


	    \begin{minipage}{0.3\textwidth}
	    \centering
	    \tdplotsetmaincoords{60}{130}
	    \begin{tikzpicture}[scale=2,tdplot_main_coords]
	    \coordinate (O) at (0,0,0);
	    \tdplotsetcoord{P}{1.732}{54.74}{45}

	    \draw[color=red] (O) -- (Px);
	    \draw[color=red] (O) -- (Py);
	    \draw[color=red] (O) -- (Pz);
	    \draw[color=red] (Px) -- (Pxy);
	    \draw[color=red] (Py) -- (Pxy);
	    \draw[color=red] (Px) -- (Pxz);
	    \draw[color=red] (Pz) -- (Pxz);
	    \draw[color=red] (Py) -- (Pyz);
	    \draw[color=red] (Pz) -- (Pyz);
	    \draw[color=red] (Pxy) -- (P);
	    \draw[color=red] (Pxz) -- (P);
	    \draw[color=red] (Pyz) -- (P);

	    \draw[color=blue] (0.0,0.0,0.0) -- (0.2,0.0,0.0);
	    \draw[color=blue] (0.2,0.0,0.0) -- (0.2,0.2,0.0);
	    \draw[color=blue] (0.2,0.2,0.0) -- (0.0,0.2,0.0);
	    \draw[color=blue] (0.0,0.2,0.0) -- (0.0,0.0,0.0);

	    \end{tikzpicture}
	    \end{minipage}
	    \begin{minipage}{0.3\textwidth}
	    \centering
	    \tdplotsetmaincoords{60}{130}

	    \begin{tikzpicture}[scale=2,tdplot_main_coords]
	    \coordinate (O) at (0,0,0);
	    \tdplotsetcoord{P}{1.732}{54.74}{45}

	    \draw[color=red] (O) -- (Px);
	    \draw[color=red] (O) -- (Py);
	    \draw[color=red] (O) -- (Pz);
	    \draw[color=red] (Px) -- (Pxy);
	    \draw[color=red] (Py) -- (Pxy);
	    \draw[color=red] (Px) -- (Pxz);
	    \draw[color=red] (Pz) -- (Pxz);
	    \draw[color=red] (Py) -- (Pyz);
	    \draw[color=red] (Pz) -- (Pyz);
	    \draw[color=red] (Pxy) -- (P);
	    \draw[color=red] (Pxz) -- (P);
	    \draw[color=red] (Pyz) -- (P);

	    \FPset\a{0.2}
	    \FPset\k{0.0}
	    \FPset\j{0.0}
	    \FPadd\ja\j\a
	    \foreach \i in {0.0,0.2,...,0.8}{
		\FPadd\ia\i\a

		    \coordinate (A) at (\i,\j,\k);
		\coordinate (B) at (\ia,\j,\k);
		\coordinate (C) at (\ia,\ja,\k);
		\coordinate (D) at (\i,\ja,\k);

		\draw[color=blue] (A) -- (B);
		\draw[color=blue] (B) -- (C);
		\draw[color=blue] (C) -- (D);
		\draw[color=blue] (D) -- (A);
	    }

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\k{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \j in {0.0,0.2,...,0.8}{
	    \FPadd\ja\j\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\ia,\j,\k);
	    \coordinate (C) at (\ia,\ja,\k);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\end{tikzpicture}
\end{minipage}

\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.0,0.0,1.0) -- (0.2,0.0,1.0);
\draw[color=blue] (0.2,0.0,1.0) -- (0.2,0.2,1.0);
\draw[color=blue] (0.2,0.2,1.0) -- (0.0,0.2,1.0);
\draw[color=blue] (0.0,0.2,1.0) -- (0.0,0.0,1.0);

\FPset\a{0.2}
\FPset\k{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \j in {0.0,0.2,...,0.8}{
	    \FPadd\ja\j\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\ia,\j,\k);
	    \coordinate (C) at (\ia,\ja,\k);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\k{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \j in {0.0,0.2,...,0.8}{
	    \FPadd\ja\j\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\ia,\j,\k);
	    \coordinate (C) at (\ia,\ja,\k);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\FPset\a{0.2}
\FPset\k{1.0}
\FPset\j{0.0}
\FPadd\ja\j\a
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a

	\coordinate (A) at (\i,\j,\k);
    \coordinate (B) at (\ia,\j,\k);
    \coordinate (C) at (\ia,\ja,\k);
    \coordinate (D) at (\i,\ja,\k);

    \draw[color=blue] (A) -- (B);
    \draw[color=blue] (B) -- (C);
    \draw[color=blue] (C) -- (D);
    \draw[color=blue] (D) -- (A);
}

\draw[color=blue] (0.0,0.0,1.0) -- (0.2,0.0,1.0);
\draw[color=blue] (0.2,0.0,1.0) -- (0.2,0.2,1.0);
\draw[color=blue] (0.2,0.2,1.0) -- (0.0,0.2,1.0);
\draw[color=blue] (0.0,0.2,1.0) -- (0.0,0.0,1.0);

\draw[color=blue] (0.2,0.0,1.0) -- (0.4,0.0,1.0);
\draw[color=blue] (0.4,0.0,1.0) -- (0.4,0.2,1.0);
\draw[color=blue] (0.4,0.2,1.0) -- (0.2,0.2,1.0);

\draw[color=blue] (0.4,0.0,1.0) -- (0.6,0.0,1.0);
\draw[color=blue] (0.6,0.0,1.0) -- (0.6,0.2,1.0);
\draw[color=blue] (0.6,0.2,1.0) -- (0.4,0.2,1.0);

\draw[color=blue] (0.4,0.0,1.0) -- (0.6,0.0,1.0);
\draw[color=blue] (0.6,0.0,1.0) -- (0.6,0.2,1.0);
\draw[color=blue] (0.6,0.2,1.0) -- (0.4,0.2,1.0);

\draw[color=blue] (0.6,0.0,1.0) -- (0.8,0.0,1.0);
\draw[color=blue] (0.8,0.0,1.0) -- (0.8,0.2,1.0);
\draw[color=blue] (0.8,0.2,1.0) -- (0.6,0.2,1.0);

\draw[color=blue] (0.8,0.0,1.0) -- (1.0,0.0,1.0);
\draw[color=blue] (1.0,0.0,1.0) -- (1.0,0.2,1.0);
\draw[color=blue] (1.0,0.2,1.0) -- (0.8,0.2,1.0);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\k{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \j in {0.0,0.2,...,0.8}{
	    \FPadd\ja\j\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\ia,\j,\k);
	    \coordinate (C) at (\ia,\ja,\k);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\FPset\a{0.2}
\FPset\k{1.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \j in {0.0,0.2,...,0.8}{
	    \FPadd\ja\j\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\ia,\j,\k);
	    \coordinate (C) at (\ia,\ja,\k);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\end{tikzpicture}
\end{minipage}

\subsection{JK surfaces}

\begin{lstlisting}
for (int j=0; j<nj; ++j)
{
    for (int k=0; k<nk; ++k)
    {
	(0,j,k) , (0, j, k+1) , (0, j+1, k+1) , (0, j+1, k);
	(ni,j,k), (ni, j, k+1), (ni, j+1, k+1), (ni, j+1, k);
    }

    parent of lower surface: 
	cell (0, j, k)
    parent of upper surface: 
	cell (ni-1, j, k)
}
\end{lstlisting}


	    \begin{minipage}{0.3\textwidth}
	    \centering
	    \tdplotsetmaincoords{60}{130}

	    \begin{tikzpicture}[scale=2,tdplot_main_coords]
	    \coordinate (O) at (0,0,0);
	    \tdplotsetcoord{P}{1.732}{54.74}{45}

	    \draw[color=red] (O) -- (Px);
	    \draw[color=red] (O) -- (Py);
	    \draw[color=red] (O) -- (Pz);
	    \draw[color=red] (Px) -- (Pxy);
	    \draw[color=red] (Py) -- (Pxy);
	    \draw[color=red] (Px) -- (Pxz);
	    \draw[color=red] (Pz) -- (Pxz);
	    \draw[color=red] (Py) -- (Pyz);
	    \draw[color=red] (Pz) -- (Pyz);
	    \draw[color=red] (Pxy) -- (P);
	    \draw[color=red] (Pxz) -- (P);
	    \draw[color=red] (Pyz) -- (P);

	    \draw[color=blue] (0.0,0.0,0.0) -- (0.0,0.0,0.2);
	    \draw[color=blue] (0.0,0.0,0.2) -- (0.0,0.2,0.2);
	    \draw[color=blue] (0.0,0.2,0.2) -- (0.0,0.2,0.0);
	    \draw[color=blue] (0.0,0.2,0.0) -- (0.0,0.0,0.0);

	    \end{tikzpicture}
	    \end{minipage}
	    \begin{minipage}{0.3\textwidth}
	    \centering
	    \tdplotsetmaincoords{60}{130}

	    \begin{tikzpicture}[scale=2,tdplot_main_coords]
	    \coordinate (O) at (0,0,0);
	    \tdplotsetcoord{P}{1.732}{54.74}{45}

	    \draw[color=red] (O) -- (Px);
	    \draw[color=red] (O) -- (Py);
	    \draw[color=red] (O) -- (Pz);
	    \draw[color=red] (Px) -- (Pxy);
	    \draw[color=red] (Py) -- (Pxy);
	    \draw[color=red] (Px) -- (Pxz);
	    \draw[color=red] (Pz) -- (Pxz);
	    \draw[color=red] (Py) -- (Pyz);
	    \draw[color=red] (Pz) -- (Pyz);
	    \draw[color=red] (Pxy) -- (P);
	    \draw[color=red] (Pxz) -- (P);
	    \draw[color=red] (Pyz) -- (P);

	    \FPset\a{0.2}
	    \FPset\i{0.0}
	    \FPset\j{0.0}
	    \FPadd\ja\j\a
	    \foreach \k in {0.0,0.2,...,0.8}{
		\FPadd\ka\k\a

		    \coordinate (A) at (\i,\j,\k);
		\coordinate (B) at (\i,\j,\ka);
		\coordinate (C) at (\i,\ja,\ka);
		\coordinate (D) at (\i,\ja,\k);

		\draw[color=blue] (A) -- (B);
		\draw[color=blue] (B) -- (C);
		\draw[color=blue] (C) -- (D);
		\draw[color=blue] (D) -- (A);
	    }

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\i{0.0}
\foreach \j in {0.0,0.2,...,0.8}{
    \FPadd\ja\j\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\i,\ja,\ka);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\end{tikzpicture}
\end{minipage}

\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\i{0.0}
\foreach \j in {0.0,0.2,...,0.8}{
    \FPadd\ja\j\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\i,\ja,\ka);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\draw[color=blue] (1.0,0.0,0.0) -- (1.0,0.0,0.2);
\draw[color=blue] (1.0,0.0,0.2) -- (1.0,0.2,0.2);
\draw[color=blue] (1.0,0.2,0.2) -- (1.0,0.2,0.0);
\draw[color=blue] (1.0,0.2,0.0) -- (1.0,0.0,0.0);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\i{0.0}
\foreach \j in {0.0,0.2,...,0.8}{
    \FPadd\ja\j\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\i,\ja,\ka);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\FPset\a{0.2}
\FPset\i{1.0}
\FPset\j{0.0}
\FPadd\ja\j\a
\foreach \k in {0.0,0.2,...,0.8}{
    \FPadd\ka\k\a

	\coordinate (A) at (\i,\j,\k);
    \coordinate (B) at (\i,\j,\ka);
    \coordinate (C) at (\i,\ja,\ka);
    \coordinate (D) at (\i,\ja,\k);

    \draw[color=blue] (A) -- (B);
    \draw[color=blue] (B) -- (C);
    \draw[color=blue] (C) -- (D);
    \draw[color=blue] (D) -- (A);
}

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\i{0.0}
\foreach \j in {0.0,0.2,...,0.8}{
    \FPadd\ja\j\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\i,\ja,\ka);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\FPset\a{0.2}
\FPset\i{1.0}
\foreach \j in {0.0,0.2,...,0.8}{
    \FPadd\ja\j\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\i,\ja,\ka);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\end{tikzpicture}
\end{minipage}

\subsection{IK surfaces}

\begin{lstlisting}
for (int i=0; i<ni; ++i)
{
    for (int k=0; k<nk; ++k)
    {
	(i,0,k) , (i+1, 0, k) , (i+1, 0, k+1) , (i, 0, k+1);
	(i,nj,k), (i+1, nj, k), (i+1, nj, k+1), (i, nj, k+1);
    }

    parent of lower surface: 
	cell (i, 0, k)
    parent of upper surface: 
	cell (i, nj-1, k)
}
\end{lstlisting}

\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.0,0.0,0.0) -- (0.0,0.0,0.2);
\draw[color=blue] (0.0,0.0,0.2) -- (0.2,0.0,0.2);
\draw[color=blue] (0.2,0.0,0.2) -- (0.2,0.0,0.0);
\draw[color=blue] (0.2,0.0,0.0) -- (0.0,0.0,0.0);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\j{0.0}
\FPset\i{0.0}
\FPadd\ia\i\a
\foreach \k in {0.0,0.2,...,0.8}{
    \FPadd\ka\k\a

	\coordinate (A) at (\i,\j,\k);
    \coordinate (B) at (\i,\j,\ka);
    \coordinate (C) at (\ia,\j,\ka);
    \coordinate (D) at (\ia,\j,\k);

    \draw[color=blue] (A) -- (B);
    \draw[color=blue] (B) -- (C);
    \draw[color=blue] (C) -- (D);
    \draw[color=blue] (D) -- (A);
}

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\j{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\ia,\j,\ka);
	    \coordinate (D) at (\ia,\j,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\FPset\a{0.2}
\FPset\j{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\ia,\j,\ka);
	    \coordinate (D) at (\ia,\j,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\end{tikzpicture}
\end{minipage}

\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\j{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\ia,\j,\ka);
	    \coordinate (D) at (\ia,\j,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\draw[color=blue] (0.0,1.0,0.0) -- (0.0,1.0,0.2);
\draw[color=blue] (0.0,1.0,0.2) -- (0.2,1.0,0.2);
\draw[color=blue] (0.2,1.0,0.2) -- (0.2,1.0,0.0);
\draw[color=blue] (0.2,1.0,0.0) -- (0.0,1.0,0.0);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\j{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\ia,\j,\ka);
	    \coordinate (D) at (\ia,\j,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\FPset\a{0.2}
\FPset\j{1.0}
\FPset\i{0.0}
\FPadd\ia\i\a
\foreach \k in {0.0,0.2,...,0.8}{
    \FPadd\ka\k\a

	\coordinate (A) at (\i,\j,\k);
    \coordinate (B) at (\i,\j,\ka);
    \coordinate (C) at (\ia,\j,\ka);
    \coordinate (D) at (\ia,\j,\k);

    \draw[color=blue] (A) -- (B);
    \draw[color=blue] (B) -- (C);
    \draw[color=blue] (C) -- (D);
    \draw[color=blue] (D) -- (A);
}

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
\tdplotsetmaincoords{60}{130}

\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\j{0.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\ia,\j,\ka);
	    \coordinate (D) at (\ia,\j,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\FPset\a{0.2}
\FPset\j{1.0}
\foreach \i in {0.0,0.2,...,0.8}{
    \FPadd\ia\i\a
	\foreach \k in {0.0,0.2,...,0.8}{
	    \FPadd\ka\k\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\i,\j,\ka);
	    \coordinate (C) at (\ia,\j,\ka);
	    \coordinate (D) at (\ia,\j,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
}

\end{tikzpicture}
\end{minipage}

\section{Making cells}


	      \begin{figure}[H]
	      \centering
	      \tdplotsetmaincoords{60}{130}

	      \begin{tikzpicture}[scale=2,tdplot_main_coords]
	      \coordinate (O) at (0,0,0);
	      \tdplotsetcoord{P}{1.732}{54.74}{45}

	      \draw[color=red] (O) -- (Px);
	      \draw[color=red] (O) -- (Py);
	      \draw[color=red] (O) -- (Pz);
	      \draw[color=red] (Px) -- (Pxy);
	      \draw[color=red] (Py) -- (Pxy);
	      \draw[color=red] (Px) -- (Pxz);
	      \draw[color=red] (Pz) -- (Pxz);
	      \draw[color=red] (Py) -- (Pyz);
	      \draw[color=red] (Pz) -- (Pyz);
	      \draw[color=red] (Pxy) -- (P);
	      \draw[color=red] (Pxz) -- (P);
	      \draw[color=red] (Pyz) -- (P);

	      \fill (0.0,0.0) circle (0.3mm) node[anchor=east]{0};
\fill (Px) circle (0.3mm) node[anchor=east]{1};
\fill (Pxy) circle (0.3mm) node[anchor=east]{2};
\fill (Py) circle (0.3mm) node[anchor=east]{3};

\fill (Pz) circle (0.3mm) node[anchor=east]{4};
\fill (Pxz) circle (0.3mm) node[anchor=east]{5};
\fill (P) circle (0.3mm) node[anchor=east]{6};
\fill (Pyz) circle (0.3mm) node[anchor=east]{7};
\end{tikzpicture}
\end{figure}

\begin{lstlisting}
for (int k=0; k<nk; ++k)
{
    for (int j=0; j<nj; ++j)
    {
	for (int i=0; i<ni; ++i)
	{
	    (i  , j,   k),
            (i+1, j,   k),
            (i+1, j+1, k),
            (i  , j+1, k);

	    (i  , j,   k+1),
            (i+1, j,   k+1),
            (i+1, j+1, k+1),
            (i  , j+1, k+1);
	}
    }
}
\end{lstlisting}

\section{Making faces}

\subsection{IJ faces}

\begin{lstlisting}
for (int k=1; k<nk; ++k)
{
    for (int j=0; j<nj; ++j)
    {
	for (int i=0; i<ni; ++i)
	{
	    (i  , j,   k),
            (i+1, j,   k),
            (i+1, j+1, k),
            (i  , j+1, k);

	    parents: 
		1: cell (i, j, k-1)
		2: cell (i, j, k)
	}
    }
}
\end{lstlisting}

\begin{minipage}{0.25\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\draw[color=blue] (0.0,0.0,0.2) -- (0.2,0.0,0.2);
\draw[color=blue] (0.2,0.0,0.2) -- (0.2,0.2,0.2);
\draw[color=blue] (0.2,0.2,0.2) -- (0.0,0.2,0.2);
\draw[color=blue] (0.0,0.2,0.2) -- (0.0,0.0,0.2);

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.25\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\FPset\k{0.2}
\FPset\j{0.0}
%\foreach \j in {0.0,0.2,...,0.8}{
    \FPadd\ja\j\a
	\foreach \i in {0.0,0.2,...,0.8}{
	    \FPadd\ia\i\a

		\coordinate (A) at (\i,\j,\k);
	    \coordinate (B) at (\ia,\j,\k);
	    \coordinate (C) at (\ia,\ja,\k);
	    \coordinate (D) at (\i,\ja,\k);

	    \draw[color=blue] (A) -- (B);
	    \draw[color=blue] (B) -- (C);
	    \draw[color=blue] (C) -- (D);
	    \draw[color=blue] (D) -- (A);
	}
    %}

    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{0.25\textwidth}
    \centering
    \tdplotsetmaincoords{60}{130}
    \begin{tikzpicture}[scale=2,tdplot_main_coords]
    \coordinate (O) at (0,0,0);
    \tdplotsetcoord{P}{1.732}{54.74}{45}

    \draw[color=red] (O) -- (Px);
    \draw[color=red] (O) -- (Py);
    \draw[color=red] (O) -- (Pz);
    \draw[color=red] (Px) -- (Pxy);
    \draw[color=red] (Py) -- (Pxy);
    \draw[color=red] (Px) -- (Pxz);
    \draw[color=red] (Pz) -- (Pxz);
    \draw[color=red] (Py) -- (Pyz);
    \draw[color=red] (Pz) -- (Pyz);
    \draw[color=red] (Pxy) -- (P);
    \draw[color=red] (Pxz) -- (P);
    \draw[color=red] (Pyz) -- (P);

    \FPset\a{0.2}
    \FPset\k{0.2}
    \foreach \j in {0.0,0.2,...,0.8}{
	\FPadd\ja\j\a
	    \foreach \i in {0.0,0.2,...,0.8}{
		\FPadd\ia\i\a

		    \coordinate (A) at (\i,\j,\k);
		\coordinate (B) at (\ia,\j,\k);
		\coordinate (C) at (\ia,\ja,\k);
		\coordinate (D) at (\i,\ja,\k);

		\draw[color=blue] (A) -- (B);
		\draw[color=blue] (B) -- (C);
		\draw[color=blue] (C) -- (D);
		\draw[color=blue] (D) -- (A);
	    }
    }

\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.25\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\foreach \k in {0.2,0.4,...,0.8}{
    \foreach \j in {0.0,0.2,...,0.8}{
	\FPadd\ja\j\a
	    \foreach \i in {0.0,0.2,...,0.8}{
		\FPadd\ia\i\a

		    \coordinate (A) at (\i,\j,\k);
		\coordinate (B) at (\ia,\j,\k);
		\coordinate (C) at (\ia,\ja,\k);
		\coordinate (D) at (\i,\ja,\k);

		\draw[color=blue] (A) -- (B);
		\draw[color=blue] (B) -- (C);
		\draw[color=blue] (C) -- (D);
		\draw[color=blue] (D) -- (A);
	    }
    }
}

\end{tikzpicture}
\end{minipage}


\subsection{JK faces}

\begin{lstlisting}
for (int i=1; i<ni; ++i)
{
    for (int j=0; j<nj; ++j)
    {
	for (int k=0; k<nk; ++k)
	{
	    (i  , j  , k),
            (i  , j  , k+1),
            (i+1, j+1, k+1),
            (i  , j+1, k);

	    parents: 
		1: cell (i-1, j, k)
		2: cell (i, j, k)
	}
    }
}
\end{lstlisting}

	\begin{minipage}{0.25\textwidth}
	\centering
	\tdplotsetmaincoords{60}{130}
	\begin{tikzpicture}[scale=2,tdplot_main_coords]
	\coordinate (O) at (0,0,0);
	\tdplotsetcoord{P}{1.732}{54.74}{45}

	\draw[color=red] (O) -- (Px);
	\draw[color=red] (O) -- (Py);
	\draw[color=red] (O) -- (Pz);
	\draw[color=red] (Px) -- (Pxy);
	\draw[color=red] (Py) -- (Pxy);
	\draw[color=red] (Px) -- (Pxz);
	\draw[color=red] (Pz) -- (Pxz);
	\draw[color=red] (Py) -- (Pyz);
	\draw[color=red] (Pz) -- (Pyz);
	\draw[color=red] (Pxy) -- (P);
	\draw[color=red] (Pxz) -- (P);
	\draw[color=red] (Pyz) -- (P);

	\draw[color=blue] (0.2,0.0,0.0) -- (0.2,0.2,0.0);
	\draw[color=blue] (0.2,0.2,0.0) -- (0.2,0.2,0.2);
	\draw[color=blue] (0.2,0.2,0.2) -- (0.2,0.0,0.2);
	\draw[color=blue] (0.2,0.0,0.2) -- (0.2,0.0,0.0);

	\end{tikzpicture}
	\end{minipage}
	\begin{minipage}{0.25\textwidth}
	\centering
	\tdplotsetmaincoords{60}{130}
	\begin{tikzpicture}[scale=2,tdplot_main_coords]
	\coordinate (O) at (0,0,0);
	\tdplotsetcoord{P}{1.732}{54.74}{45}

	\draw[color=red] (O) -- (Px);
	\draw[color=red] (O) -- (Py);
	\draw[color=red] (O) -- (Pz);
	\draw[color=red] (Px) -- (Pxy);
	\draw[color=red] (Py) -- (Pxy);
	\draw[color=red] (Px) -- (Pxz);
	\draw[color=red] (Pz) -- (Pxz);
	\draw[color=red] (Py) -- (Pyz);
	\draw[color=red] (Pz) -- (Pyz);
	\draw[color=red] (Pxy) -- (P);
	\draw[color=red] (Pxz) -- (P);
	\draw[color=red] (Pyz) -- (P);

	\FPset\a{0.2}
	\FPset\j{0.0}
	\FPset\i{0.2}
	%\foreach \j in {0.0,0.2,...,0.8}{
	    \FPadd\ja\j\a
		\foreach \k in {0.0,0.2,...,0.8}{
		    \FPadd\ka\k\a

			\coordinate (A) at (\i,\j,\k);
		    \coordinate (B) at (\i,\ja,\k);
		    \coordinate (C) at (\i,\ja,\ka);
		    \coordinate (D) at (\i,\j,\ka);

		    \draw[color=blue] (A) -- (B);
		    \draw[color=blue] (B) -- (C);
		    \draw[color=blue] (C) -- (D);
		    \draw[color=blue] (D) -- (A);
		}
	    %}

	    \end{tikzpicture}
	    \end{minipage}
	    \begin{minipage}{0.25\textwidth}
	    \centering
	    \tdplotsetmaincoords{60}{130}
	    \begin{tikzpicture}[scale=2,tdplot_main_coords]
	    \coordinate (O) at (0,0,0);
	    \tdplotsetcoord{P}{1.732}{54.74}{45}

	    \draw[color=red] (O) -- (Px);
	    \draw[color=red] (O) -- (Py);
	    \draw[color=red] (O) -- (Pz);
	    \draw[color=red] (Px) -- (Pxy);
	    \draw[color=red] (Py) -- (Pxy);
	    \draw[color=red] (Px) -- (Pxz);
	    \draw[color=red] (Pz) -- (Pxz);
	    \draw[color=red] (Py) -- (Pyz);
	    \draw[color=red] (Pz) -- (Pyz);
	    \draw[color=red] (Pxy) -- (P);
	    \draw[color=red] (Pxz) -- (P);
	    \draw[color=red] (Pyz) -- (P);

	    \FPset\a{0.2}
	    \FPset\i{0.2}
	    \foreach \j in {0.0,0.2,...,0.8}{
		\FPadd\ja\j\a
		    \foreach \k in {0.0,0.2,...,0.8}{
			\FPadd\ka\k\a

			    \coordinate (A) at (\i,\j,\k);
			\coordinate (B) at (\i,\ja,\k);
			\coordinate (C) at (\i,\ja,\ka);
			\coordinate (D) at (\i,\j,\ka);

			\draw[color=blue] (A) -- (B);
			\draw[color=blue] (B) -- (C);
			\draw[color=blue] (C) -- (D);
			\draw[color=blue] (D) -- (A);
		    }
	    }


\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.25\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\foreach \i in {0.2,0.4,...,0.8}{
    \foreach \j in {0.0,0.2,...,0.8}{
	\FPadd\ja\j\a
	    \foreach \k in {0.0,0.2,...,0.8}{
		\FPadd\ka\k\a

		    \coordinate (A) at (\i,\j,\k);
		\coordinate (B) at (\i,\ja,\k);
		\coordinate (C) at (\i,\ja,\ka);
		\coordinate (D) at (\i,\j,\ka);

		\draw[color=blue] (A) -- (B);
		\draw[color=blue] (B) -- (C);
		\draw[color=blue] (C) -- (D);
		\draw[color=blue] (D) -- (A);
	    }
    }
}

\end{tikzpicture}
\end{minipage}

\subsection{IK faces}

\begin{lstlisting}
for (int j=1; j<nj; ++j)
{
    for (int i=0; i<ni; ++i)
    {
	for (int k=0; k<nk; ++k)
	{
	    (i  , j, k),
            (i+1, j, k),
            (i+1, j, k+1),
            (i  , j, k+1);

	    parents: 
		1: cell (i, j-1, k)
		2: cell (i, j  , k)
	}
    }
}
\end{lstlisting}

	\begin{minipage}{0.25\textwidth}
	\centering
	\tdplotsetmaincoords{60}{130}
	\begin{tikzpicture}[scale=2,tdplot_main_coords]
	\coordinate (O) at (0,0,0);
	\tdplotsetcoord{P}{1.732}{54.74}{45}

	\draw[color=red] (O) -- (Px);
	\draw[color=red] (O) -- (Py);
	\draw[color=red] (O) -- (Pz);
	\draw[color=red] (Px) -- (Pxy);
	\draw[color=red] (Py) -- (Pxy);
	\draw[color=red] (Px) -- (Pxz);
	\draw[color=red] (Pz) -- (Pxz);
	\draw[color=red] (Py) -- (Pyz);
	\draw[color=red] (Pz) -- (Pyz);
	\draw[color=red] (Pxy) -- (P);
	\draw[color=red] (Pxz) -- (P);
	\draw[color=red] (Pyz) -- (P);

	\FPset\a{0.2}
	\FPset\i{0.0}
	\FPset\j{0.2}
	\FPset\k{0.0}
	%\foreach \j in {0.0,0.2,...,0.8}{
	    \FPadd\ia\i\a
		%\foreach \k in {0.0,0.2,...,0.1}{
		    \FPadd\ka\k\a

			\coordinate (A) at (\i,\j,\k);
		    \coordinate (B) at (\ia,\j,\k);
		    \coordinate (C) at (\ia,\j,\ka);
		    \coordinate (D) at (\i,\j,\ka);

		    \draw[color=blue] (A) -- (B);
		    \draw[color=blue] (B) -- (C);
		    \draw[color=blue] (C) -- (D);
		    \draw[color=blue] (D) -- (A);
		    %}
	    %}

	    %\draw[color=blue] (0.2,0.0,0.0) -- (0.2,0.2,0.0);
	    %\draw[color=blue] (0.2,0.2,0.0) -- (0.2,0.2,0.2);
	    %\draw[color=blue] (0.2,0.2,0.2) -- (0.2,0.0,0.2);
	    %\draw[color=blue] (0.2,0.0,0.2) -- (0.2,0.0,0.0);

	    \end{tikzpicture}
	    \end{minipage}
	    \begin{minipage}{0.25\textwidth}
	    \centering
	    \tdplotsetmaincoords{60}{130}
	    \begin{tikzpicture}[scale=2,tdplot_main_coords]
	    \coordinate (O) at (0,0,0);
	    \tdplotsetcoord{P}{1.732}{54.74}{45}

	    \draw[color=red] (O) -- (Px);
	    \draw[color=red] (O) -- (Py);
	    \draw[color=red] (O) -- (Pz);
	    \draw[color=red] (Px) -- (Pxy);
	    \draw[color=red] (Py) -- (Pxy);
	    \draw[color=red] (Px) -- (Pxz);
	    \draw[color=red] (Pz) -- (Pxz);
	    \draw[color=red] (Py) -- (Pyz);
	    \draw[color=red] (Pz) -- (Pyz);
	    \draw[color=red] (Pxy) -- (P);
	    \draw[color=red] (Pxz) -- (P);
	    \draw[color=red] (Pyz) -- (P);

	    \FPset\a{0.2}
	    \FPset\i{0.0}
	    \FPset\j{0.2}
	    %\foreach \j in {0.0,0.2,...,0.8}{
		\FPadd\ia\i\a
		    \foreach \k in {0.0,0.2,...,0.8}{
			\FPadd\ka\k\a

			    \coordinate (A) at (\i,\j,\k);
			\coordinate (B) at (\ia,\j,\k);
			\coordinate (C) at (\ia,\j,\ka);
			\coordinate (D) at (\i,\j,\ka);

			\draw[color=blue] (A) -- (B);
			\draw[color=blue] (B) -- (C);
			\draw[color=blue] (C) -- (D);
			\draw[color=blue] (D) -- (A);
		    }
		%}

		\end{tikzpicture}
		\end{minipage}
		\begin{minipage}{0.25\textwidth}
		\centering
		\tdplotsetmaincoords{60}{130}
		\begin{tikzpicture}[scale=2,tdplot_main_coords]
		\coordinate (O) at (0,0,0);
		\tdplotsetcoord{P}{1.732}{54.74}{45}

		\draw[color=red] (O) -- (Px);
		\draw[color=red] (O) -- (Py);
		\draw[color=red] (O) -- (Pz);
		\draw[color=red] (Px) -- (Pxy);
		\draw[color=red] (Py) -- (Pxy);
		\draw[color=red] (Px) -- (Pxz);
		\draw[color=red] (Pz) -- (Pxz);
		\draw[color=red] (Py) -- (Pyz);
		\draw[color=red] (Pz) -- (Pyz);
		\draw[color=red] (Pxy) -- (P);
		\draw[color=red] (Pxz) -- (P);
		\draw[color=red] (Pyz) -- (P);

		\FPset\a{0.2}
		\FPset\j{0.2}
		\foreach \i in {0.0,0.2,...,0.8}{
		    \FPadd\ia\i\a
			\foreach \k in {0.0,0.2,...,0.8}{
			    \FPadd\ka\k\a

				\coordinate (A) at (\i,\j,\k);
			    \coordinate (B) at (\ia,\j,\k);
			    \coordinate (C) at (\ia,\j,\ka);
			    \coordinate (D) at (\i,\j,\ka);

			    \draw[color=blue] (A) -- (B);
			    \draw[color=blue] (B) -- (C);
			    \draw[color=blue] (C) -- (D);
			    \draw[color=blue] (D) -- (A);
			}
		}


\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.25\textwidth}
\centering
\tdplotsetmaincoords{60}{130}
\begin{tikzpicture}[scale=2,tdplot_main_coords]
\coordinate (O) at (0,0,0);
\tdplotsetcoord{P}{1.732}{54.74}{45}

\draw[color=red] (O) -- (Px);
\draw[color=red] (O) -- (Py);
\draw[color=red] (O) -- (Pz);
\draw[color=red] (Px) -- (Pxy);
\draw[color=red] (Py) -- (Pxy);
\draw[color=red] (Px) -- (Pxz);
\draw[color=red] (Pz) -- (Pxz);
\draw[color=red] (Py) -- (Pyz);
\draw[color=red] (Pz) -- (Pyz);
\draw[color=red] (Pxy) -- (P);
\draw[color=red] (Pxz) -- (P);
\draw[color=red] (Pyz) -- (P);

\FPset\a{0.2}
\foreach \j in {0.2,0.4,...,0.8}{
    \foreach \i in {0.0,0.2,...,0.8}{
	\FPadd\ia\i\a
	    \foreach \k in {0.0,0.2,...,0.8}{
		\FPadd\ka\k\a

		    \coordinate (A) at (\i,\j,\k);
		\coordinate (B) at (\ia,\j,\k);
		\coordinate (C) at (\ia,\j,\ka);
		\coordinate (D) at (\i,\j,\ka);

		\draw[color=blue] (A) -- (B);
		\draw[color=blue] (B) -- (C);
		\draw[color=blue] (C) -- (D);
		\draw[color=blue] (D) -- (A);
	    }
    }
}

\end{tikzpicture}
\end{minipage}

	 \end{document}
